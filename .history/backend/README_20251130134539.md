# NGO Backend API

A production-ready Express.js + MongoDB backend for the NGO website.

## Folder Structure

```
backend/
├── config/
│   └── db.js              # MongoDB connection configuration
├── controllers/
│   └── teacherController.js  # Business logic for teachers
├── models/
│   └── Teacher.js         # Teacher schema and model
├── routes/
│   └── teacherRoutes.js   # Teacher API routes
├── middleware/            # Custom middleware (if needed)
├── server.js              # Express app setup and server start
├── seed.js                # Database seeding script
├── package.json           # Dependencies and scripts
├── .env.example           # Environment variables template
└── README.md              # This file
```

## Installation

1. Copy `.env.example` to `.env` and update values:

```bash
cp .env.example .env
```

2. Install dependencies:

```bash
npm install
```

3. (Optional) Seed the database with sample data:

```bash
npm run seed
```

4. Start the server:

```bash
# Production
npm start

# Development (with auto-reload)
npm run dev
```

The server will run on `http://localhost:5000` by default.

## Admin Panel

The backend includes an AdminJS admin panel for managing all data models.

- **URL**: `http://localhost:5000/admin`
- **Access**: Only users with `super-admin` or `admin` roles can access
- **Features**:
  - Manage Users, Blogs, Events, Contacts, Stories, Awards, FAQs, Publications
  - Manage Volunteers, Donors, Internships, Videos, Club Registrations
  - Manage Site Configuration and Teachers
  - Full CRUD operations on all models
  - User authentication with role-based access

To create an admin user, use:
```bash
npm run create-admin
```

## API Endpoints

### Health Check
- `GET /` → Returns API status and admin panel URL

### Authentication
- `POST /api/auth/register` → Register a new user (requires authentication for admin creation)
- `POST /api/auth/login` → Login user
  - Body: `{ "email": "user@example.com", "password": "password" }`
- `GET /api/auth/profile` → Get current user profile (requires authentication)

### Teachers
- `GET /api/teachers` → Get all teachers
- `POST /api/teachers` → Create a new teacher
  - Body: `{ "name": "Teacher Name" }`
- `GET /api/teachers/:id` → Get teacher by ID

### Blogs
- `GET /api/blogs` → Get all blogs
- `GET /api/blogs/:id` → Get blog by ID
- `POST /api/blogs` → Create blog (requires authentication)
- `PUT /api/blogs/:id` → Update blog (requires authentication)
- `DELETE /api/blogs/:id` → Delete blog (requires authentication)

### Events
- `GET /api/event` → Get all events
- `GET /api/event/:id` → Get event by ID
- `POST /api/event` → Create event (requires authentication)
- `PUT /api/event/:id` → Update event (requires authentication)
- `DELETE /api/event/:id` → Delete event (requires authentication)

### Contacts (Public Submission)
- `GET /api/contacts` → Get all contacts (requires authentication)
- `GET /api/contacts/:id` → Get contact by ID (requires authentication)
- `POST /api/contacts` → Submit contact form (public)
- `PUT /api/contacts/:id` → Update contact (requires authentication)
- `DELETE /api/contacts/:id` → Delete contact (requires authentication)

### Other Endpoints
Similar patterns for:
- `/api/story` - Stories
- `/api/awards` - Awards
- `/api/faqs` - FAQs
- `/api/publications` - Publications
- `/api/internships` - Internships (POST is public for submissions)
- `/api/volunteers` - Volunteers (POST is public for submissions)
- `/api/donors` - Donors (POST is public for submissions)
- `/api/videos` - Videos
- `/api/clubs` - Club Registrations (POST is public for submissions)
- `/api/config` - Site Configuration
- `/api/upload` - File Uploads (requires authentication)

## Example Requests

```bash
# Get all teachers
curl http://localhost:5000/api/teachers

# Create a teacher
curl -X POST http://localhost:5000/api/teachers \
  -H "Content-Type: application/json" \
  -d '{"name":"John Doe"}'

# Get animals
curl http://localhost:5000/api/animals
```

## Environment Variables

Create a `.env` file in the backend directory with:

```env
PORT=5000
MONGO_URI=mongodb://localhost:27017/ngo-db
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
ADMINJS_COOKIE_SECRET=your-adminjs-cookie-secret-change-this-in-production
NODE_ENV=development
```

- `PORT` - Server port (default: 5000)
- `MONGO_URI` - MongoDB connection string (default: mongodb://localhost:27017/ngo-db)
- `JWT_SECRET` - Secret key for JWT token generation (required for authentication)
- `ADMINJS_COOKIE_SECRET` - Secret key for AdminJS session cookies (required for admin panel)
- `NODE_ENV` - Environment mode (development/production)

## Requirements

- Node.js >= 14
- MongoDB running locally or MongoDB Atlas URI

## License

MIT
